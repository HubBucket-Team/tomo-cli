"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.tasks=void 0;var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_path=require("path"),_utils=require("../../utils"),_common=require("../../utils/common"),_Scaffolder=require("../../utils/Scaffolder");const ESLINT_DEPENDENCIES=["eslint","babel-eslint","eslint-config-omaha-prime-grade","watch"],ESLINT_REACT_PLUGINS=["eslint-plugin-react"],tasks=[{text:"Create ESLint configuration and .eslintignore files",task:function(){var a=(0,_asyncToGenerator2.default)(function*(){yield new _utils.EslintConfigModuleEditor().create().commit(),yield new _Scaffolder.Scaffolder((0,_path.join)(__dirname,"templates")).copy(".eslintignore").commit()});return function task(){return a.apply(this,arguments)}}(),condition:()=>(0,_common.allDoNotExist)(".eslintrc.js",".eslintrc",".eslintrc.json",".eslintrc.yml")},{text:"Add lint tasks to package.json",task:function(){var a=(0,_asyncToGenerator2.default)(function*({sourceDirectory:a}){yield new _utils.PackageJsonEditor().extend({scripts:{lint:`eslint . -c ./.eslintrc.js --fix`,"lint:watch":`watch 'npm run lint' ${a}`,"lint:tests":"eslint __tests__/**/*.js -c ./.eslintrc.js --fix --no-ignore"}}).commit()});return function task(){return a.apply(this,arguments)}}(),condition:()=>(0,_common.someDoExist)("package.json")},{text:"Install ESLint dependencies",task:({skipInstall:a})=>(0,_utils.install)(ESLINT_DEPENDENCIES,{dev:!0,skipInstall:a}),condition:({isNotOffline:a})=>a&&(0,_common.someDoExist)("package.json")},{text:"Install ESLint React plugins",task:({skipInstall:a})=>(0,_utils.install)(ESLINT_REACT_PLUGINS,{dev:!0,skipInstall:a}),condition:({useReact:a})=>a&&(0,_common.someDoExist)("package.json"),optional:({isNotOffline:a,useReact:b})=>a&&b},{text:"Add React support to ESLint configuration file",task:function(){var a=(0,_asyncToGenerator2.default)(function*({reactVersion:a}){yield new _utils.EslintConfigModuleEditor().extend({parserOptions:{ecmaFeatures:{jsx:!0}},settings:{react:{version:`'${a}'`}},extends:["omaha-prime-grade","plugin:react/recommended"]}).commit()});return function task(){return a.apply(this,arguments)}}(),condition:({useReact:a})=>a&&(0,_common.someDoExist)(".eslintrc.js"),optional:({useReact:a})=>a}];exports.tasks=tasks;var _default=tasks;exports.default=_default;