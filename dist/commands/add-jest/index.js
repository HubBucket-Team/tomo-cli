"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.addJest=void 0;var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_path=require("path"),_utils=require("../../utils"),_common=require("../../utils/common"),_Scaffolder=require("../../utils/Scaffolder");const ALWAYS=()=>!0,JEST_DEPENDENCIES=["jest","babel-jest"],sourceDirectory=(0,_path.join)(__dirname,"templates"),scaffolder=new _Scaffolder.Scaffolder({sourceDirectory}),addJest=[{text:"Add test tasks and Jest configuration to package.json",task:function(){var a=(0,_asyncToGenerator2.default)(function*({browser:a}){const b={testMatch:["**/__tests__/**/*.(e2e|test).[jt]s?(x)"],setupFilesAfterEnv:a?["<rootDir>/__tests__/setup.js"]:void 0};yield new _utils.PackageJsonEditor().extend({jest:b,scripts:{test:"jest .*.test.js --coverage","test:watch":"npm test -- --watchAll"}}).commit()});return function task(){return a.apply(this,arguments)}}(),condition:()=>(0,_common.someDoExist)("package.json")},{text:"Copy Jest boilerplate",task:function(){var a=(0,_asyncToGenerator2.default)(function*({browser:a}){a&&(yield scaffolder.target("__tests__").copy("setup.js")),yield scaffolder.target("__tests__").copy("example.test.js").commit()});return function task(){return a.apply(this,arguments)}}(),condition:ALWAYS},{text:"Install Jest dependencies",task:({skipInstall:a})=>(0,_utils.install)(JEST_DEPENDENCIES,{dev:!0,skipInstall:a}),condition:({isNotOffline:a})=>a&&(0,_common.someDoExist)("package.json")}];exports.addJest=addJest;var _default=addJest;exports.default=_default;